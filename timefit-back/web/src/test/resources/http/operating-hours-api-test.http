### ================================================================
### Timefit Operating Hours API - ê²€ì¦ ì—ëŸ¬ í…ŒìŠ¤íŠ¸
### ğŸ“ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:
###    1. Owner ë¡œê·¸ì¸
###    2. BH-01 ìœ„ë°˜: ì˜ì—…ì‹œê°„ ì„¤ì • ì‹œ ì¢…ë£Œì‹œê°„ì´ ì‹œì‘ì‹œê°„ë³´ë‹¤ ì´ë¥¸ ê²½ìš°
###    3. OH-01 ìœ„ë°˜: ì˜ˆì•½ ìŠ¬ë¡¯ ì‹œê°„ì´ ì˜ì—…ì‹œê°„ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ëŠ” ê²½ìš°
###    4. OH-05-v2 ìœ„ë°˜: ë¯¸ë˜ ì˜ˆì•½ì´ ì¡´ì¬í•˜ëŠ” ìš”ì¼ì˜ ì˜ˆì•½ ìŠ¬ë¡¯ ë³€ê²½ ì‹œë„
### ================================================================
###
### ğŸ“Œ ì‚¬ì „ ì¤€ë¹„:
###    - seed-bulk.sql ì‹¤í–‰ í•„ìš” (Business, Menu ë°ì´í„°)
###    - ë§Œì•½ test data ìƒì„±í•œ ì§€ ì˜¤ë˜ ë˜ì—ˆë‹¤ë©´ ì‚­ì œ í›„ ë‹¤ì‹œ ìƒì„±í•˜ê¸¸ ê¶Œì¥í•¨ (ë¯¸ë˜ì˜ˆì•½ê²€ì¦ ë•Œë¬¸ì—)
###    - Business ID: 30000000-0000-0000-0000-000000000001 (Timefit Hair Salon)
###    - Owner: owner1@timefit.com / password: password123
###
###
### ğŸ¯ ê²€ì¦ ê·œì¹™ (ì´ 3ê°œ):
###    - BH-01: ì˜ì—…ì‹œê°„ ë²”ìœ„ ë‚´ ì˜ˆì•½ ìŠ¬ë¡¯ ì‹œê°„ ê²€ì¦ (closeTime > openTime)
###    - OH-01: ì˜ˆì•½ ìŠ¬ë¡¯ ì‹œê°„ âŠ† ì˜ì—…ì‹œê°„ ê²€ì¦ (bookingTimeRanges âŠ† businessHours)
###    - OH-05-v2: ë¯¸ë˜ ì˜ˆì•½ ë³´í˜¸ (ì˜ˆì•½ ì¡´ì¬ ì‹œ ì˜ˆì•½ ìŠ¬ë¡¯ ë³€ê²½ ì°¨ë‹¨)
### ================================================================

@baseUrl = http://localhost:8080
@businessId = 30000000-0000-0000-0000-000000000001

### ================================================================
### 1. Owner ë¡œê·¸ì¸
### ================================================================

# @name Ownerë¡œê·¸ì¸
POST {{baseUrl}}/api/auth/signin
Content-Type: application/json

{
  "email": "owner1@timefit.com",
  "password": "password123"
}

> {%
    client.test("ë¡œê·¸ì¸ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•¨");
    });

    if (response.body.data && response.body.data.accessToken) {
        client.global.set("ownerToken", response.body.data.accessToken);
        console.log("âœ… [1/8] Owner ë¡œê·¸ì¸ ì„±ê³µ");
    } else {
        console.error("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:", response.status, response.body);
    }
%}


###


### ================================================================
### 2. BH-01 ìœ„ë°˜: ì˜ì—…ì‹œê°„ ì„¤ì • ì‹œ ì¢…ë£Œì‹œê°„ì´ ì‹œì‘ì‹œê°„ë³´ë‹¤ ì´ë¥¸ ê²½ìš°
### Use Case: ì‚¬ì—…ìê°€ ì›”ìš”ì¼ ì˜ì—…ì‹œê°„ì„ 18:00 ì‹œì‘ ~ 09:00 ì¢…ë£Œë¡œ ì˜ëª» ì…ë ¥
### Expected: INVALID_OPERATING_HOURS (400)
### ================================================================

# @name BH01_ì‹œê°„ìˆœì„œìœ„ë°˜
PUT {{baseUrl}}/api/business/{{businessId}}/operating-hours
Authorization: Bearer {{ownerToken}}
Content-Type: application/json

{
  "schedules": [
    { "dayOfWeek": 0, "isClosed": true, "openTime": null, "closeTime": null, "bookingTimeRanges": [] },
    { "dayOfWeek": 1, "isClosed": false, "openTime": "18:00", "closeTime": "09:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 2, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 3, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 4, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 5, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 6, "isClosed": true, "openTime": null, "closeTime": null, "bookingTimeRanges": [] }
  ]
}

> {%
    client.test("BH-01 ê²€ì¦ ì—ëŸ¬", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•¨");
        if (response.body.errorResponse) {
            client.assert(
                response.body.errorResponse.code === "INVALID_OPERATING_HOURS",
                "INVALID_OPERATING_HOURS ì—ëŸ¬ì—¬ì•¼ í•¨"
            );
        }
    });

    if (response.status === 400) {
        console.log("âœ… [6/8] BH-01 ê²€ì¦ ì—ëŸ¬ ë°œìƒ (ì •ìƒ)");
        console.log("   - Use Case: ì¢…ë£Œì‹œê°„(09:00) < ì‹œì‘ì‹œê°„(18:00)");
        console.log("   - ì—ëŸ¬ ì½”ë“œ:", response.body.errorResponse?.code);
        console.log("   - ì—ëŸ¬ ë©”ì‹œì§€:", response.body.errorResponse?.message);
    } else {
        console.error("âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ:", response.status, response.body);
    }
%}

###

### ================================================================
### 3. OH-01 ìœ„ë°˜: ì˜ˆì•½ ìŠ¬ë¡¯ ì‹œê°„ì´ ì˜ì—…ì‹œê°„ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ëŠ” ê²½ìš°
### Use Case: ì‚¬ì—…ìê°€ ì˜ì—…ì‹œê°„(09:00-18:00) ë°–ì˜ ì˜ˆì•½ ìŠ¬ë¡¯(08:00-12:00, 13:00-19:00) ì„¤ì • ì‹œë„
### Expected: OPERATING_HOURS_OUT_OF_RANGE (400)
### ================================================================

# @name OH01_ë²”ìœ„ì´ˆê³¼
PUT {{baseUrl}}/api/business/{{businessId}}/operating-hours
Authorization: Bearer {{ownerToken}}
Content-Type: application/json

{
  "schedules": [
    { "dayOfWeek": 0, "isClosed": true, "openTime": null, "closeTime": null, "bookingTimeRanges": [] },
    {
      "dayOfWeek": 1,
      "isClosed": false,
      "openTime": "09:00",
      "closeTime": "18:00",
      "bookingTimeRanges": [
        { "startTime": "08:00", "endTime": "12:00" },
        { "startTime": "13:00", "endTime": "19:00" }
      ]
    },
    { "dayOfWeek": 2, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 3, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 4, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 5, "isClosed": false, "openTime": "09:00", "closeTime": "18:00", "bookingTimeRanges": [] },
    { "dayOfWeek": 6, "isClosed": true, "openTime": null, "closeTime": null, "bookingTimeRanges": [] }
  ]
}

> {%
    client.test("OH-01 ê²€ì¦ ì—ëŸ¬", function() {
        client.assert(response.status === 400, "ì‘ë‹µ ì½”ë“œê°€ 400ì´ì–´ì•¼ í•¨");
        if (response.body.errorResponse) {
            client.assert(
                response.body.errorResponse.code === "OPERATING_HOURS_OUT_OF_RANGE",
                "OPERATING_HOURS_OUT_OF_RANGE ì—ëŸ¬ì—¬ì•¼ í•¨"
            );
        }
    });

    if (response.status === 400) {
        console.log("âœ… [7/8] OH-01 ê²€ì¦ ì—ëŸ¬ ë°œìƒ (ì •ìƒ)");
        console.log("   - Use Case: ì˜ˆì•½ ìŠ¬ë¡¯(08:00-19:00) âŠ„ ì˜ì—…ì‹œê°„(09:00-18:00)");
        console.log("   - ì—ëŸ¬ ì½”ë“œ:", response.body.errorResponse?.code);
        console.log("   - ì—ëŸ¬ ë©”ì‹œì§€:", response.body.errorResponse?.message);
    } else {
        console.error("âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ:", response.status, response.body);
    }
%}

###

### ================================================================
### 4. OH-05-v2 ìœ„ë°˜: ë¯¸ë˜ ì˜ˆì•½ì´ ì¡´ì¬í•˜ëŠ” ìš”ì¼ì˜ ì˜ˆì•½ ìŠ¬ë¡¯ ë³€ê²½ ì‹œë„
### Use Case: ì‚¬ì—…ìê°€ ëª©ìš”ì¼(2026-02-05)ì— í™•ì •ëœ ë¯¸ë˜ ì˜ˆì•½ì´ ìˆëŠ” ìƒíƒœì—ì„œ
###           ëª©ìš”ì¼ ì˜ˆì•½ ìŠ¬ë¡¯ì„ ìˆ˜ì • ì‹œë„
### Expected: OPERATING_HOURS_HAS_FUTURE_RESERVATIONS(409)
### ================================================================

# @name OH05v2_ë¯¸ë˜ì˜ˆì•½ë³´í˜¸
PUT {{baseUrl}}/api/business/{{businessId}}/operating-hours
Authorization: Bearer {{ownerToken}}
Content-Type: application/json

{
  "schedules": [
    {
      "dayOfWeek": 0,
      "isClosed": true,
      "openTime": null,
      "closeTime": null,
      "bookingTimeRanges": []
    },
    {
      "dayOfWeek": 1,
      "isClosed": false,
      "openTime": "09:00",
      "closeTime": "18:00",
      "bookingTimeRanges": [
        { "startTime": "09:00", "endTime": "12:00" },
        { "startTime": "13:00", "endTime": "18:00" }
      ]
    },
    {
      "dayOfWeek": 2,
      "isClosed": false,
      "openTime": "09:00",
      "closeTime": "18:00",
      "bookingTimeRanges": [
        { "startTime": "09:00", "endTime": "12:00" },
        { "startTime": "13:00", "endTime": "18:00" }
      ]
    },
    {
      "dayOfWeek": 3,
      "isClosed": false,
      "openTime": "09:00",
      "closeTime": "18:00",
      "bookingTimeRanges": [
        { "startTime": "09:00", "endTime": "12:00" },
        { "startTime": "13:00", "endTime": "18:00" }
      ]
    },
    {
      "dayOfWeek": 4,
      "isClosed": false,
      "openTime": "09:00",
      "closeTime": "18:00",
      "bookingTimeRanges": [
        { "startTime": "09:00", "endTime": "12:00" },
        { "startTime": "13:00", "endTime": "18:00" }
      ]
    },
    {
      "dayOfWeek": 5,
      "isClosed": false,
      "openTime": "09:00",
      "closeTime": "18:00",
      "bookingTimeRanges": [
        { "startTime": "09:00", "endTime": "12:00" },
        { "startTime": "13:00", "endTime": "18:00" }
      ]
    },
    {
      "dayOfWeek": 6,
      "isClosed": true,
      "openTime": null,
      "closeTime": null,
      "bookingTimeRanges": []
    }
  ]
}

> {%
    client.test("ë¯¸ë˜ì˜ˆì•½ë³´í˜¸ ì„¤ì • ì„±ê³µ", function() {
        client.assert(response.status === 409, "ì‘ë‹µ ì½”ë“œê°€ 409ì´ì–´ì•¼ í•¨");
    });

    if (response.status === 409) {
        console.log("ì—ëŸ¬ ê²€ì¶œ ì„±ê³µ! ì„±ê³µì ìœ¼ë¡œ ì˜ì—… ìŠ¬ë¡¯ ì‹œê°„ ìˆ˜ì •ì„ Blocking í–ˆìŠµë‹ˆë‹¤.");
    } else {
        console.error("âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:", response.status);
        if (response.body && response.body.errorResponse) {
            console.error("   - ì—ëŸ¬:", response.body.errorResponse.message);
        }
    }
%}

###
