### ================================================================
### Timefit Operating Hours Toggle í…ŒìŠ¤íŠ¸
### ğŸ“ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:
###    1. Owner ë¡œê·¸ì¸ (seed-bulk.sql ë°ì´í„° ì‚¬ìš©)
###    2. ì˜ì—…ì‹œê°„ ì „ì²´ ì¡°íšŒ (ì´ˆê¸° ìƒíƒœ í™•ì¸)
###    3. ì›”ìš”ì¼ ì˜¤ì „(sequence=0) íœ´ë¬´ í† ê¸€ â†’ isClosed: false â†’ true
###    4. ì˜ì—…ì‹œê°„ ì¬ì¡°íšŒ (ë³€ê²½ í™•ì¸)
###    5. ì›”ìš”ì¼ ì˜¤ì „(sequence=0) ë‹¤ì‹œ í† ê¸€ â†’ isClosed: true â†’ false
###    6. ì˜ì—…ì‹œê°„ ì¬ì¡°íšŒ (ì›ë³µ í™•ì¸)
###    7. ì›”ìš”ì¼ ì˜¤í›„(sequence=1) íœ´ë¬´ í† ê¸€ í…ŒìŠ¤íŠ¸
###    8. í† ìš”ì¼(sequence=0) íœ´ë¬´ í† ê¸€ í…ŒìŠ¤íŠ¸
###    9. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” sequence í…ŒìŠ¤íŠ¸ (ì—ëŸ¬ 404)
###    10. ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ì í…ŒìŠ¤íŠ¸ (Customerë¡œ ì‹œë„ â†’ ì—ëŸ¬ 403)
### ================================================================
###
### ğŸ“Œ ì‚¬ì „ ì¤€ë¹„:
###    - seed-bulk.sql ì‹¤í–‰ í•„ìš”
###    - Business ID: 30000000-0000-0000-0000-000000000001 (Timefit Hair Salon)
###    - Owner: owner1@timefit.com / password: password123
###    - Customer: customer1@timefit.com / password: password123
###
### ğŸ“Š Operating Hours ì´ˆê¸° ë°ì´í„°:
###    ì›”~ê¸ˆ: sequence=0 (09:00-12:00), sequence=1 (13:00-18:00)
###    í† ~ì¼: sequence=0 (09:00-14:00)
###
### ğŸ”¢ dayOfWeek ê°’ (Enum ORDINAL):
###    0=MONDAY, 1=TUESDAY, 2=WEDNESDAY, 3=THURSDAY, 4=FRIDAY, 5=SATURDAY, 6=SUNDAY
### ================================================================

@baseUrl = http://localhost:8080
@businessId = 30000000-0000-0000-0000-000000000001

### ================================================================
### 1. Owner ë¡œê·¸ì¸ (seed-bulk.sql ë°ì´í„°)
### ================================================================

# @name Ownerë¡œê·¸ì¸
POST {{baseUrl}}/api/auth/signin
Content-Type: application/json

{
  "email": "owner1@timefit.com",
  "password": "password123"
}

> {%
    client.test("ë¡œê·¸ì¸ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•¨");
    });

    if (response.body.data && response.body.data.accessToken) {
        client.global.set("ownerToken", response.body.data.accessToken);
        console.log("âœ… [1/10] Owner ë¡œê·¸ì¸ ì„±ê³µ");
        console.log("   - Email: owner1@timefit.com");
        console.log("   - User ID:", response.body.data.userId);
    } else {
        console.error("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 2. ì˜ì—…ì‹œê°„ ì „ì²´ ì¡°íšŒ (ì´ˆê¸° ìƒíƒœ í™•ì¸)
### ================================================================

# @name ì˜ì—…ì‹œê°„ì¡°íšŒ_ì´ˆê¸°
GET {{baseUrl}}/api/business/{{businessId}}/operating-hours
Authorization: Bearer {{ownerToken}}

> {%
    client.test("ì˜ì—…ì‹œê°„ ì¡°íšŒ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•¨");
    });

    if (response.status === 200) {
        console.log("âœ… [2/10] ì˜ì—…ì‹œê°„ ì¡°íšŒ ì„±ê³µ");
        console.log("   - Business:", response.body.data.businessName);

        // ì›”ìš”ì¼(dayOfWeek=0) í™•ì¸
        const monday = response.body.data.schedules.find(s => s.dayOfWeek === 0);
        if (monday) {
            console.log("   - ì›”ìš”ì¼ ì˜ì—…ì‹œê°„:", monday.openTime, "~", monday.closeTime);
            console.log("   - ì›”ìš”ì¼ ì˜ˆì•½ ì‹œê°„ëŒ€ ê°œìˆ˜:", monday.bookingTimeRanges.length);
            monday.bookingTimeRanges.forEach(range => {
                console.log("     * sequence=" + range.sequence + ":", range.startTime, "~", range.endTime, "/ isClosed:", range.isClosed);
            });
        }
    } else {
        console.error("âŒ ì¡°íšŒ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 3. ì›”ìš”ì¼ ì˜¤ì „(sequence=0) íœ´ë¬´ í† ê¸€ â†’ isClosed: false â†’ true
### ================================================================

# @name ì›”ìš”ì¼ì˜¤ì „_íœ´ë¬´í† ê¸€_1ì°¨
PATCH {{baseUrl}}/api/business/{{businessId}}/operating-hours/0/0/toggle
Authorization: Bearer {{ownerToken}}

> {%
    client.test("í† ê¸€ ì„±ê³µ", function() {
        client.assert(response.status === 200, "ì‘ë‹µ ì½”ë“œê°€ 200ì´ì–´ì•¼ í•¨");
    });

    if (response.status === 200) {
        console.log("âœ… [3/10] ì›”ìš”ì¼ ì˜¤ì „(seq=0) íœ´ë¬´ í† ê¸€ ì„±ê³µ");

        const monday = response.body.data.schedules.find(s => s.dayOfWeek === 0);
        const morningSlot = monday.bookingTimeRanges.find(r => r.sequence === 0);

        console.log("   - í† ê¸€ ê²°ê³¼: isClosed =", morningSlot.isClosed);
        console.log("   - ì‹œê°„ëŒ€:", morningSlot.startTime, "~", morningSlot.endTime);

        client.assert(morningSlot.isClosed === true, "isClosedê°€ trueì—¬ì•¼ í•¨");
    } else {
        console.error("âŒ í† ê¸€ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 4. ì˜ì—…ì‹œê°„ ì¬ì¡°íšŒ (ë³€ê²½ í™•ì¸)
### ================================================================

# @name ì˜ì—…ì‹œê°„ì¡°íšŒ_1ì°¨í† ê¸€í›„
GET {{baseUrl}}/api/business/{{businessId}}/operating-hours
Authorization: Bearer {{ownerToken}}

> {%
    if (response.status === 200) {
        console.log("âœ… [4/10] í† ê¸€ í›„ ì˜ì—…ì‹œê°„ ì¬ì¡°íšŒ");

        const monday = response.body.data.schedules.find(s => s.dayOfWeek === 0);
        const morningSlot = monday.bookingTimeRanges.find(r => r.sequence === 0);
        const afternoonSlot = monday.bookingTimeRanges.find(r => r.sequence === 1);

        console.log("   - ì›”ìš”ì¼ ì˜¤ì „(seq=0): isClosed =", morningSlot.isClosed, "(ë³€ê²½ë¨ âœ“)");
        console.log("   - ì›”ìš”ì¼ ì˜¤í›„(seq=1): isClosed =", afternoonSlot.isClosed, "(ê·¸ëŒ€ë¡œ)");

        client.assert(morningSlot.isClosed === true, "ì˜¤ì „ì€ íœ´ë¬´ì—¬ì•¼ í•¨");
        client.assert(afternoonSlot.isClosed === false, "ì˜¤í›„ëŠ” ì˜ì—…ì´ì–´ì•¼ í•¨");
    } else {
        console.error("âŒ ì¡°íšŒ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 5. ì›”ìš”ì¼ ì˜¤ì „(sequence=0) ë‹¤ì‹œ í† ê¸€ â†’ isClosed: true â†’ false
### ================================================================

# @name ì›”ìš”ì¼ì˜¤ì „_íœ´ë¬´í† ê¸€_2ì°¨
PATCH {{baseUrl}}/api/business/{{businessId}}/operating-hours/0/0/toggle
Authorization: Bearer {{ownerToken}}

> {%
    if (response.status === 200) {
        console.log("âœ… [5/10] ì›”ìš”ì¼ ì˜¤ì „(seq=0) ì¬í† ê¸€ ì„±ê³µ");

        const monday = response.body.data.schedules.find(s => s.dayOfWeek === 0);
        const morningSlot = monday.bookingTimeRanges.find(r => r.sequence === 0);

        console.log("   - ì¬í† ê¸€ ê²°ê³¼: isClosed =", morningSlot.isClosed);

        client.assert(morningSlot.isClosed === false, "isClosedê°€ falseë¡œ ì›ë³µë˜ì–´ì•¼ í•¨");
    } else {
        console.error("âŒ ì¬í† ê¸€ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 6. ì˜ì—…ì‹œê°„ ì¬ì¡°íšŒ (ì›ë³µ í™•ì¸)
### ================================================================

# @name ì˜ì—…ì‹œê°„ì¡°íšŒ_2ì°¨í† ê¸€í›„
GET {{baseUrl}}/api/business/{{businessId}}/operating-hours
Authorization: Bearer {{ownerToken}}

> {%
    if (response.status === 200) {
        console.log("âœ… [6/10] ì¬í† ê¸€ í›„ ì˜ì—…ì‹œê°„ ì¬ì¡°íšŒ");

        const monday = response.body.data.schedules.find(s => s.dayOfWeek === 0);
        const morningSlot = monday.bookingTimeRanges.find(r => r.sequence === 0);

        console.log("   - ì›”ìš”ì¼ ì˜¤ì „(seq=0): isClosed =", morningSlot.isClosed, "(ì›ë³µë¨ âœ“)");

        client.assert(morningSlot.isClosed === false, "ì˜¤ì „ì´ ë‹¤ì‹œ ì˜ì—…ìœ¼ë¡œ ëŒì•„ì™€ì•¼ í•¨");
    } else {
        console.error("âŒ ì¡°íšŒ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 7. ì›”ìš”ì¼ ì˜¤í›„(sequence=1) íœ´ë¬´ í† ê¸€ í…ŒìŠ¤íŠ¸
### ================================================================

# @name ì›”ìš”ì¼ì˜¤í›„_íœ´ë¬´í† ê¸€
PATCH {{baseUrl}}/api/business/{{businessId}}/operating-hours/0/1/toggle
Authorization: Bearer {{ownerToken}}

> {%
    if (response.status === 200) {
        console.log("âœ… [7/10] ì›”ìš”ì¼ ì˜¤í›„(seq=1) íœ´ë¬´ í† ê¸€ ì„±ê³µ");

        const monday = response.body.data.schedules.find(s => s.dayOfWeek === 0);
        const afternoonSlot = monday.bookingTimeRanges.find(r => r.sequence === 1);

        console.log("   - í† ê¸€ ê²°ê³¼: isClosed =", afternoonSlot.isClosed);
        console.log("   - ì‹œê°„ëŒ€:", afternoonSlot.startTime, "~", afternoonSlot.endTime);
    } else {
        console.error("âŒ í† ê¸€ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 8. í† ìš”ì¼(sequence=0) íœ´ë¬´ í† ê¸€ í…ŒìŠ¤íŠ¸
### ğŸ“Œ í† ìš”ì¼ì€ ë‹¨ì¼ ì‹œê°„ëŒ€ë§Œ ìˆìŒ (09:00-14:00, sequence=0)
### ================================================================

# @name í† ìš”ì¼_íœ´ë¬´í† ê¸€
PATCH {{baseUrl}}/api/business/{{businessId}}/operating-hours/5/0/toggle
Authorization: Bearer {{ownerToken}}

> {%
    if (response.status === 200) {
        console.log("âœ… [8/10] í† ìš”ì¼(seq=0) íœ´ë¬´ í† ê¸€ ì„±ê³µ");

        const saturday = response.body.data.schedules.find(s => s.dayOfWeek === 5);
        const saturdaySlot = saturday.bookingTimeRanges.find(r => r.sequence === 0);

        console.log("   - í† ê¸€ ê²°ê³¼: isClosed =", saturdaySlot.isClosed);
        console.log("   - ì‹œê°„ëŒ€:", saturdaySlot.startTime, "~", saturdaySlot.endTime);
    } else {
        console.error("âŒ í† ê¸€ ì‹¤íŒ¨:", response.status, response.body);
    }
%}

###

### ================================================================
### 9. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” sequence í…ŒìŠ¤íŠ¸ (ì—ëŸ¬ 404 ê¸°ëŒ€)
### ğŸ“Œ ì›”ìš”ì¼ì€ sequence 0, 1ë§Œ ìˆìŒ â†’ sequence=99ëŠ” ì—†ìŒ
### ================================================================

# @name ì¡´ì¬í•˜ì§€ì•ŠëŠ”sequence_ì—ëŸ¬í…ŒìŠ¤íŠ¸
PATCH {{baseUrl}}/api/business/{{businessId}}/operating-hours/0/99/toggle
Authorization: Bearer {{ownerToken}}

> {%
    client.test("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” sequence ì—ëŸ¬", function() {
        client.assert(response.status === 404, "ì‘ë‹µ ì½”ë“œê°€ 404ì—¬ì•¼ í•¨");
    });

    if (response.status === 404) {
        console.log("âœ… [9/10] ì¡´ì¬í•˜ì§€ ì•ŠëŠ” sequence ì—ëŸ¬ ë°œìƒ (ì •ìƒ)");
        console.log("   - ì—ëŸ¬ ì½”ë“œ:", response.body.error.errorCode);
        console.log("   - ì—ëŸ¬ ë©”ì‹œì§€:", response.body.error.message);

        client.assert(response.body.error.errorCode === "OPERATING_HOURS_NOT_FOUND",
            "ì—ëŸ¬ ì½”ë“œê°€ OPERATING_HOURS_NOT_FOUNDì—¬ì•¼ í•¨");
    } else {
        console.error("âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ:", response.status, response.body);
    }
%}

###

### ================================================================
### 10. ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ì í…ŒìŠ¤íŠ¸ (Customerë¡œ ì‹œë„ â†’ ì—ëŸ¬ 403)
### ================================================================

# @name Customerë¡œê·¸ì¸
POST {{baseUrl}}/api/auth/signin
Content-Type: application/json

{
  "email": "customer1@timefit.com",
  "password": "password123"
}

> {%
    if (response.body.data && response.body.data.accessToken) {
        client.global.set("customerToken", response.body.data.accessToken);
        console.log("ğŸ“Œ Customer ë¡œê·¸ì¸ ì„±ê³µ (ê¶Œí•œ í…ŒìŠ¤íŠ¸ìš©)");
    }
%}

###

# @name ê¶Œí•œì—†ëŠ”ì‚¬ìš©ì_ì—ëŸ¬í…ŒìŠ¤íŠ¸
PATCH {{baseUrl}}/api/business/{{businessId}}/operating-hours/0/0/toggle
Authorization: Bearer {{customerToken}}

> {%
    client.test("ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ì ì—ëŸ¬", function() {
        client.assert(response.status === 403, "ì‘ë‹µ ì½”ë“œê°€ 403ì´ì–´ì•¼ í•¨");
    });

    if (response.status === 403) {
        console.log("âœ… [10/10] ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ì ì—ëŸ¬ ë°œìƒ (ì •ìƒ)");
        console.log("   - ì—ëŸ¬ ì½”ë“œ:", response.body.error.errorCode);
        console.log("   - ì—ëŸ¬ ë©”ì‹œì§€:", response.body.error.message);

        client.assert(response.body.error.errorCode === "INSUFFICIENT_PERMISSION" ||
            response.body.error.errorCode === "USER_NOT_BUSINESS_MEMBER",
            "ê¶Œí•œ ê´€ë ¨ ì—ëŸ¬ ì½”ë“œì—¬ì•¼ í•¨");
    } else {
        console.error("âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µ:", response.status, response.body);
    }
%}

###

### ================================================================
### ğŸ‰ í…ŒìŠ¤íŠ¸ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸
### ================================================================
### âœ… 1. Owner ë¡œê·¸ì¸
### âœ… 2. ì˜ì—…ì‹œê°„ ì „ì²´ ì¡°íšŒ (ì´ˆê¸° ìƒíƒœ)
### âœ… 3. ì›”ìš”ì¼ ì˜¤ì „ íœ´ë¬´ í† ê¸€ (false â†’ true)
### âœ… 4. ë³€ê²½ í™•ì¸ (ì¬ì¡°íšŒ)
### âœ… 5. ì›”ìš”ì¼ ì˜¤ì „ ì¬í† ê¸€ (true â†’ false)
### âœ… 6. ì›ë³µ í™•ì¸ (ì¬ì¡°íšŒ)
### âœ… 7. ì›”ìš”ì¼ ì˜¤í›„ íœ´ë¬´ í† ê¸€
### âœ… 8. í† ìš”ì¼ íœ´ë¬´ í† ê¸€
### âœ… 9. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” sequence ì—ëŸ¬ (404)
### âœ… 10. ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ì ì—ëŸ¬ (403)
### ================================================================
