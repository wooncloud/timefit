-- ============================================================
-- ì¹´í…Œê³ ë¦¬ ìƒì„¸ ì¡°íšŒ
-- ============================================================
-- API:        GET /api/business/{id}/category/{cid}
-- í•µì‹¬ ì¿¼ë¦¬:  SELECT * FROM business_category WHERE id = ?
-- ì‚¬ì „ì¡°ê±´:   _setup.sql (User, Business)
-- ============================================================

BEGIN;

-- ============================================================
-- ğŸ”§ í”½ìŠ¤ì²˜
-- ============================================================
-- business_category 1ê±´ë§Œ
-- ì´ìœ : WHERE id (PK ì¡°ê±´) â†’ í…Œì´ë¸” í¬ê¸° ë¬´ê´€í•˜ê²Œ Index Scan

INSERT INTO business_category (
    id, 
    business_id, 
    business_type, 
    category_name, 
    is_active, 
    created_at, 
    updated_at
)
VALUES (
    '99999999-0000-0000-0000-000000000300',
    '99999999-0000-0000-0000-000000000100',
    'BD008',
    'Test Category',
    true,
    NOW(),
    NOW()
);

-- ============================================================
-- ğŸ” EXPLAIN: ì¹´í…Œê³ ë¦¬ ìƒì„¸ ì¡°íšŒ
-- ============================================================

EXPLAIN (ANALYZE, BUFFERS)
SELECT 
    id,
    business_id,
    business_type,
    category_name,
    category_notice,
    is_active,
    created_at,
    updated_at
FROM business_category
WHERE id = '99999999-0000-0000-0000-000000000300';

-- ============================================================
-- ğŸ’¡ í™•ì¸ í¬ì¸íŠ¸
-- ============================================================
-- âœ… Scan íƒ€ì…: í•­ìƒ Index Scan using business_category_pkey
--    - PK ì¡°ê±´ì€ í…Œì´ë¸” í¬ê¸°ì™€ ë¬´ê´€í•˜ê²Œ Index Scan ì„ íƒ
--
-- âœ… Index Cond: (id = '...')
--    - ì¡°ê±´ì´ ì¸ë±ìŠ¤ë¡œ ì§ì ‘ ì²˜ë¦¬ë¨
--
-- âœ… actual rows = 1 (ì •í™•íˆ 1ê±´)
--    - PKëŠ” uniqueí•˜ë¯€ë¡œ Plannerê°€ ì •í™•íˆ ì˜ˆì¸¡
--
-- âœ… costê°€ ë§¤ìš° ë‚®ìŒ (ì¼ë°˜ì ìœ¼ë¡œ 8~10 ë²”ìœ„)
--    - ì¸ë±ìŠ¤ ë£¨íŠ¸ â†’ ë¦¬í”„ â†’ í…Œì´ë¸” ì ‘ê·¼ (3~4ë²ˆì˜ í˜ì´ì§€ ì½ê¸°)

ROLLBACK;
